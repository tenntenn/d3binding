var sb={BindingMaster:function(){var b=[];this.add=function(a){null===a||"undefined"===typeof a||0>b.indexOf(a)&&b.push(a)};this.notify=function(a,c){b.filter(function(a){var b=!1;Object.keys(a.inputs).forEach(function(f){a.inputs.hasOwnProperty(f)&&a.inputs[f]===c&&(b=!0)});return b}).forEach(function(c){c.notify(a)})};this.remove=function(a){a=b.lastIndexOf(a);0<=a&&b.splice(a,1)}},Binding:function(b,a,c,d){this.inputs=a;this.outputs=c;this.compute=d;this.bind=function(){b.add(this);return this};
this.unbind=function(){b.remove(this);return this};this.notify=function(b){var f=d(a),g=b[b.length-1];Object.keys(f).forEach(function(a){var d=c[a];g!==d&&c.hasOwnProperty(a)&&sb.isObservable(d)&&d.notify(b,f[a])});return this}},Observable:function(b,a){var c=function(b){void 0!==b&&c.notify([],b);return a};c.notify=function(d,e){0>d.lastIndexOf(c)&&(a=e,b.notify(d.concat(c),c))};c.observable=this;this.property=c},isObservable:function(b){return b instanceof sb.Observable||b.observable&&b.observable instanceof
sb.Observable?!0:!1}};
(function(){sb.BindingChain=function(b,a){var c=[];this.synchronize=function(){var d=[],e=arguments;Object.keys(e).forEach(function(b){b=e[b];sb.isObservable(b)&&0<=a.indexOf(b)&&d.push(b)});d.forEach(function(a){var e={input:a},h={};d.forEach(function(b,c){a!==b&&(h["output"+c]=b)});e=new sb.Binding(b,e,h,function(a){var b={};Object.keys(h).forEach(function(c){b[c]=a.input()});return b});c.push(e)});return this};this.compute=function(d,e){if(!sb.isObservable(d)||"function"!==typeof e||0>a.indexOf(d))return this;
var f={};a.forEach(function(a,b){d!==a&&(f["input"+b]=a)});var g=new sb.Binding(b,f,{output:d},function(a){return{output:e(a)}});c.push(g);return this};this.onChange=function(d,e){if(!sb.isObservable(d)||"function"!==typeof e||0>a.indexOf(d))return this;var f=new sb.Binding(b,{input:d},{},function(){e();return{}});c.push(f);return this};this.bind=function(){c.forEach(function(a){a.bind()});return this};this.unbind=function(){c.forEach(function(a){a.unbind()});return this}}})();
(function(){var b=new sb.BindingMaster;sb.binding=function(){var a=[],c=arguments;Object.keys(c).forEach(function(b){b=c[b];sb.isObservable(b)&&a.push(b)});return new sb.BindingChain(b,a)};sb.observable=function(a){return(new sb.Observable(b,a)).property}})();
var d3binding={expandable:function(){var b=function(){var a=[];for(i in arguments)arguments.hasOwnProperty(i)&&a.push(arguments[i]);b.funcs.forEach(function(d){d.apply(b,a)})};b.funcs=[];var a=arguments;for(i in a)"function"===typeof a[i]&&(Object.keys(a[i]).forEach(function(c){a[i].hasOwnProperty(c)&&(b[c]=a[i][c])}),b.funcs.push(a[i]));b.expand=function(a){"function"===typeof a&&b.funcs.push(a);return b};return b}};
(function(){d3binding.binding=function(){var a=d3binding.expandable();a.isTransition=!1;a.transition=function(){if(!a.isTransition&&a.expand){var b=d3binding.binding();b.funcs=a.funcs;b.isTransition=!0;return b}return a};a.attr=function(c,d){return b(a,c,d,"attr")};a.style=function(c,d){return b(a,c,d,"style")};a.classed=function(c,d){return b(a,c,d,"classed")};a.text=function(c){return b(a,null,c,"text")};a.html=function(c){return b(a,null,c,"classed")};return a};var b=function(a,b,d,e){a.expand(function(f){f[e](b,
function(f){var h=d3.select(this),j=d;if("function"===typeof j&&(j=j(f),sb.isObservable(j))){var k=j;sb.binding(k).onChange(k,function(){if(a.isTransition)if(null!==b)h.transition()[e](b,k());else h.transition()[e](k());else if(null!==b)h[e](b,k());else h[e](k())}).bind();j=k()}return j})});return a}})();
(function(){d3binding.transform=function(){var b=sb.observable(""),a={binding:null,observable:sb.observable("")},c={binding:null,observable:sb.observable("")},d={binding:null,observable:sb.observable("")},e={binding:null,observable:sb.observable("")},f={binding:null,observable:sb.observable("")},g={binding:null,observable:sb.observable("")};sb.binding(b,a.observable,c.observable,d.observable,e.observable,f.observable,g.observable).compute(b,function(){var b=[];a.observable()&&b.push(a.observable());
c.observable()&&b.push(c.observable());d.observable()&&b.push(d.observable());e.observable()&&b.push(e.observable());f.observable()&&b.push(f.observable());g.observable()&&b.push(g.observable());return b.join(" ")}).bind();b.translate=function(c,d){sb.isObservable(c)&&sb.isObservable(d)&&(a.observable("translate("+c()+","+d()+")"),a.binding=sb.binding(a.observable,c,d).compute(a.observable,function(){return"translate("+c()+","+d()+")"}).bind());return b};b.scale=function(a,d){sb.isObservable(a)&&
sb.isObservable(d)&&(c.observable("scale("+a()+","+d()+")"),c.binding=sb.binding(c.observable,a,d).compute(c.observable,function(){return"scale("+a()+","+d()+")"}).bind());return b};b.rotate=function(a,c,e){sb.isObservable(a)&&(sb.isObservable(e)&&sb.isObservable(c)?(d.observable("rotate("+a()+","+c()+","+e()+")"),d.binding=sb.binding(d.observable,a,c,e).compute(d.observable,function(){return"rotate("+a()+","+c()+","+e()+")"}).bind()):(d.observable("rotate("+a()+")"),d.binding=sb.binding(d.observable,
a).compute(d.observable,function(){return"rotate("+a()+")"}).bind()));return b};b.skewX=function(a){sb.isObservable(a)&&(e.observable("skewX("+a()+")"),e.binding=sb.binding(e.observable,a).compute(e.observable,function(){return"skewX("+a()+")"}).bind());return b};b.skewY=function(a){sb.isObservable(a)&&(f.observable("skewY("+a()+")"),f.binding=sb.binding(f.observable,a).compute(f.observable,function(){return"skewY("+a()+")"}).bind());return b};b.matrix=function(a,c,d,e,f,l){sb.isObservable(a)&&(sb.isObservable(c)&&
sb.isObservable(d)&&sb.isObservable(e)&&sb.isObservable(f)&&sb.isObservable(f))&&(g.observable("matrix("+a()+","+c()+","+d()+","+e()+","+f()+","+l()+")"),g.binding=sb.binding(g.observable,a,c,d,e,f,l).compute(g.observable,function(){return"matrix("+a()+","+c()+","+d()+","+e()+","+f()+","+l()+")"}).bind());return b};return b}})();
