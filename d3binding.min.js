var sb={expandable:function(){var b=function(){var c=sb.argumentsToArray(arguments);b.funcs.forEach(function(a){a.apply(b,c)})},a=sb.argumentsToArray(arguments);b.funcs=a.filter(function(a){return"function"===typeof a});b.expand=function(a){"function"===typeof a&&b.funcs.push(a);return b};return b},Observer:function(){var b=[];this.add=function(a){null===a||"undefined"===typeof a||0>b.indexOf(a)&&b.push(a)};this.notify=function(a,c){b.filter(function(a){var e=!1;Object.keys(a.inputs).forEach(function(b){a.inputs.hasOwnProperty(b)&&
a.inputs[b]===c&&(e=!0)});return e}).forEach(function(c){c.notify(a)})};this.remove=function(a){a=b.lastIndexOf(a);0<=a&&b.splice(a,1)}},Binding:function(b,a,c,d){var e=this;e.inputs=a;e.outputs=c;e.computed=d;e.bind=function(){b.add(e);return e};e.unbind=function(){b.remove(e);return e};e.notify=function(b){var g=d(a),h=b[b.length-1];Object.keys(g).forEach(function(a){var e=c[a];h!==e&&c.hasOwnProperty(a)&&sb.isObservable(e)&&e.notify(b,g[a])});return e}},isObservable:function(b){return"function"!==
typeof b||!b.notify||"function"!==typeof b.notify?!1:!0},Observable:function(b,a){var c=this;c.property=function(b){void 0!==b&&c.property.notify([],b);return a};c.property.notify=function(d,e){0>d.lastIndexOf(c.property)&&(a=e,b.notify(d.concat(c.property),c.property))}}};
(function(){sb.ObservableArray=function(b,a){var c=this,d=a;d instanceof Array||(d=[]);c.property=function(){return d.concat()};c.property.notify=function(a){0>a.lastIndexOf(c.property)&&b.notify(a.concat(c.property),c.property)};c.property.length=function(){return d.length};c.property.get=function(a){return d[a]};c.property.set=function(a,b){d[a]=b;c.property.notify([])};"push pop shift unshift splice reverse sort".split(" ").forEach(function(a){"function"===typeof d[a]&&(c.property[a]=function(){var b=
sb.argumentsToArray(arguments),b=d[a].apply(d,b);c.property.notify([]);return b})});["concat","map","filter"].forEach(function(a){"function"===typeof d[a]&&(c.property[a]=function(){var c=sb.argumentsToArray(arguments),c=d[a].apply(d,c);return new sb.ObservableArray(b,c)})});"join toString toLocalString indexOf lastIndexOf forEach".split(" ").forEach(function(a){"function"===typeof d[a]&&(c.property[a]=function(){var b=sb.argumentsToArray(arguments);return d[a].apply(d,b)})})}})();
(function(){sb.BindingChain=function(b,a){var c=sb.expandable(),d=[];this.synchronize=function(){var e=[];sb.argumentsToArray(arguments).forEach(function(b){sb.isObservable(b)&&(e.push(b),0>a.indexOf(b)&&a.push(b))});var f=e.map(function(a){var c={input:a},d={};e.forEach(function(b,c){a!==b&&(d["output"+c]=b)});return new sb.Binding(b,c,d,function(a){var b={};Object.keys(d).forEach(function(c){b[c]=a.input()});return b})});c.expand(function(){d=d.concat(f)});return this};this.computed=function(e,
f){if(!sb.isObservable(e)||"function"!==typeof f)return this;0>a.indexOf(e)&&a.push(e);c.expand(function(){var c={};a.forEach(function(a,b){e!==a&&(c["input"+b]=a)});var h=new sb.Binding(b,c,{output:e},function(a){return{output:f(a)}});d.push(h)});return this};this.onChange=function(e,f){if(!sb.isObservable(e)||"function"!==typeof f)return this;a.indexOf(e)&&a.push(e);var g=new sb.Binding(b,{input:e},{},function(){f();return{}});c.expand(function(){d.push(g)});return this};this.bind=function(){this.unbind();
c();d.forEach(function(a){a.bind()});return this};this.unbind=function(){d.forEach(function(a){a.unbind()});d=[];return this}}})();sb.argumentsToArray=function(b){var a=[];Object.keys(b).forEach(function(c){a.push(b[c])});return a};
(function(){var b=new sb.Observer;sb.binding=function(){var a=sb.argumentsToArray(arguments).filter(function(a){return sb.isObservable(a)});return new sb.BindingChain(b,a)};sb.observable=function(a){return(new sb.Observable(b,a)).property};sb.observableArray=function(a){return(new sb.ObservableArray(b,a)).property}})();var d3binding={};
(function(){d3binding.binding=function(){var a=sb.expandable();a.isTransition=!1;a.transition=function(){if(!a.isTransition&&a.expand){var b=d3binding.binding();b.funcs=a.funcs;b.isTransition=!0;return b}return a};a.attr=function(c,d){return b(a,c,d,"attr")};a.style=function(c,d){return b(a,c,d,"style")};a.classed=function(c,d){return b(a,c,d,"classed")};a.text=function(c){return b(a,null,c,"text")};a.html=function(c){return b(a,null,c,"classed")};return a};var b=function(a,b,d,e){a.expand(function(f){f[e](b,
function(f){var h=d3.select(this),i=d;if("function"===typeof i&&(i=i(f),sb.isObservable(i))){var j=i;sb.binding(j).onChange(j,function(){if(a.isTransition)if(null!==b)h.transition()[e](b,j());else h.transition()[e](j());else if(null!==b)h[e](b,j());else h[e](j())}).bind();i=j()}return i})});return a}})();
(function(){d3binding.transform=function(){var b=sb.observable(""),a={binding:null,observable:sb.observable("")},c={binding:null,observable:sb.observable("")},d={binding:null,observable:sb.observable("")},e={binding:null,observable:sb.observable("")},f={binding:null,observable:sb.observable("")},g={binding:null,observable:sb.observable("")};sb.binding(b,a.observable,c.observable,d.observable,e.observable,f.observable,g.observable).compute(b,function(){var b=[];a.observable()&&b.push(a.observable());
c.observable()&&b.push(c.observable());d.observable()&&b.push(d.observable());e.observable()&&b.push(e.observable());f.observable()&&b.push(f.observable());g.observable()&&b.push(g.observable());return b.join(" ")}).bind();b.translate=function(c,d){sb.isObservable(c)&&sb.isObservable(d)&&(a.observable("translate("+c()+","+d()+")"),a.binding=sb.binding(a.observable,c,d).compute(a.observable,function(){return"translate("+c()+","+d()+")"}).bind());return b};b.scale=function(a,d){sb.isObservable(a)&&
sb.isObservable(d)&&(c.observable("scale("+a()+","+d()+")"),c.binding=sb.binding(c.observable,a,d).compute(c.observable,function(){return"scale("+a()+","+d()+")"}).bind());return b};b.rotate=function(a,c,e){sb.isObservable(a)&&(sb.isObservable(e)&&sb.isObservable(c)?(d.observable("rotate("+a()+","+c()+","+e()+")"),d.binding=sb.binding(d.observable,a,c,e).compute(d.observable,function(){return"rotate("+a()+","+c()+","+e()+")"}).bind()):(d.observable("rotate("+a()+")"),d.binding=sb.binding(d.observable,
a).compute(d.observable,function(){return"rotate("+a()+")"}).bind()));return b};b.skewX=function(a){sb.isObservable(a)&&(e.observable("skewX("+a()+")"),e.binding=sb.binding(e.observable,a).compute(e.observable,function(){return"skewX("+a()+")"}).bind());return b};b.skewY=function(a){sb.isObservable(a)&&(f.observable("skewY("+a()+")"),f.binding=sb.binding(f.observable,a).compute(f.observable,function(){return"skewY("+a()+")"}).bind());return b};b.matrix=function(a,c,d,e,f,k){sb.isObservable(a)&&(sb.isObservable(c)&&
sb.isObservable(d)&&sb.isObservable(e)&&sb.isObservable(f)&&sb.isObservable(f))&&(g.observable("matrix("+a()+","+c()+","+d()+","+e()+","+f()+","+k()+")"),g.binding=sb.binding(g.observable,a,c,d,e,f,k).compute(g.observable,function(){return"matrix("+a()+","+c()+","+d()+","+e()+","+f()+","+k()+")"}).bind());return b};return b}})();
