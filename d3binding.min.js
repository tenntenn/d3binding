var sb={BindingMaster:function(){var c=[];this.add=function(a){null===a||"undefined"===typeof a||0>c.indexOf(a)&&c.push(a)};this.notify=function(a,b){c.filter(function(a){var c=!1;Object.keys(a.inputs).forEach(function(f){a.inputs.hasOwnProperty(f)&&a.inputs[f]===b&&(c=!0)});return c}).forEach(function(b){b.notify(a)})};this.remove=function(a){a=c.lastIndexOf(a);0<=a&&c.splice(a,1)}},Binding:function(c,a,b,d){this.inputs=a;this.outputs=b;this.compute=d;this.bind=function(){c.add(this);return this};
this.unbind=function(){c.remove(this);return this};this.notify=function(c){var f=d(a),k=c[c.length-1];Object.keys(f).forEach(function(a){var d=b[a];k!==d&&b.hasOwnProperty(a)&&sb.isObservable(d)&&d.notify(c,f[a])});return this}},Observable:function(c,a){var b=function(c){void 0!==c&&b.notify([],c);return a};b.notify=function(d,e){0>d.lastIndexOf(b)&&(a=e,c.notify(d.concat(b),b))};b.observable=this;this.property=b},isObservable:function(c){return c instanceof sb.Observable||c.observable&&c.observable instanceof
sb.Observable?!0:!1}};
(function(){sb.BindingChain=function(c,a){var b=[];this.synchronize=function(){var d=[],e=arguments;Object.keys(e).forEach(function(b){b=e[b];sb.isObservable(b)&&0<=a.indexOf(b)&&d.push(b)});d.forEach(function(a){var e={input:a},g={};d.forEach(function(b,c){a!==b&&(g["output"+c]=b)});e=new sb.Binding(c,e,g,function(a){var b={};Object.keys(g).forEach(function(c){b[c]=a.input()});return b});b.push(e)});return this};this.compute=function(d,e){if(!sb.isObservable(d)||"function"!==typeof e||0>a.indexOf(d))return this;
var f={};a.forEach(function(a,b){d!==a&&(f["input"+b]=a)});var k=new sb.Binding(c,f,{output:d},function(a){return{output:e(a)}});b.push(k);return this};this.onChange=function(d,e){if(!sb.isObservable(d)||"function"!==typeof e||0>a.indexOf(d))return this;var f=new sb.Binding(c,{input:d},{},function(){e();return{}});b.push(f);return this};this.bind=function(){b.forEach(function(a){a.bind()});return this};this.unbind=function(){b.forEach(function(a){a.unbind()});return this}}})();
(function(){var c=new sb.BindingMaster;sb.binding=function(){var a=[],b=arguments;Object.keys(b).forEach(function(c){c=b[c];sb.isObservable(c)&&a.push(c)});return new sb.BindingChain(c,a)};sb.observable=function(a){return(new sb.Observable(c,a)).property}})();
var d3binding={expandable:function(){var c=function(){var a=[];for(i in arguments)arguments.hasOwnProperty(i)&&a.push(arguments[i]);c.funcs.forEach(function(d){d.apply(c,a)})};c.funcs=[];var a=arguments;for(i in a)"function"===typeof a[i]&&(Object.keys(a[i]).forEach(function(b){a[i].hasOwnProperty(b)&&(c[b]=a[i][b])}),c.funcs.push(a[i]));c.expand=function(a){"function"===typeof a&&c.funcs.push(a);return c};return c}};
(function(){d3binding.binding=function(){var a=d3binding.expandable();a.isTransition=!1;a.transition=function(){if(!a.isTransition&&a.expand){var b=d3binding.binding();b.funcs=a.funcs;b.isTransition=!0;return b}return a};a.attr=function(b,d){return c(a,b,d,"attr")};a.style=function(b,d){return c(a,b,d,"style")};a.classed=function(b,d){return c(a,b,d,"classed")};a.text=function(b){return c(a,null,b,"text")};a.html=function(b){return c(a,null,b,"classed")};return a};var c=function(a,b,c,e){a.expand(function(f){f[e](b,
function(f){var g=d3.select(this),h=c;if("function"===typeof h&&(h=h(f),sb.isObservable(h))){var j=h;sb.binding(j).onChange(j,function(){if(a.isTransition)if(null!==b)g.transition()[e](b,j());else g.transition()[e](j());else if(null!==b)g[e](b,j());else g[e](j())}).bind();h=j()}return h})});return a}})();
